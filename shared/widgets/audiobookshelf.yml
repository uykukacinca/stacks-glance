- &podcasts-recently-added
  type: custom-api
  title: Latest Podcasts
  cache: *default-cache
  url: ${AUDIOBOOKSHELF_URL}/audiobookshelf/api/libraries/3c472da7-7aa5-41b8-89d3-a6d938a2a88c/recent-episodes
  parameters:
    limit: 15
  headers:
    Accept: application/json
    Authorization: Bearer ${AUDIOBOOKSHELF_KEY}
  template: |
    {{ $collapseAfter := .Options.IntOr "collapse-after" 5 }}
    {{ $items := .JSON.Array "episodes" }}
    {{ if $items }}
      <ul class="list list-gap-14 collapsible-container" data-collapse-after="{{ $collapseAfter }}">
        {{ range $items }}
        <li>
            <div class="flex gap-10 row-reverse-on-mobile thumbnail-parent">
                <div class="shrink-0">
                  <img class="twitch-category-thumbnail thumbnail aspect-ratio-1-1 cover-6-66" src="${AUDIOBOOKSHELF_URL}/audiobookshelf/api/items/{{ .String "libraryItemId" }}/cover" alt="{{ .String "title" }}" loading="lazy">
                </div>
                <div class="grow min-width-0">
                  <a href="${AUDIOBOOKSHELF_URL}/audiobookshelf/item/{{ .String "libraryItemId" }}" class="color-highlight size-title-dynamic block text-truncate" target="_blank" rel="noreferrer">{{ .String "title" }}</a>
                  <div class="text-truncate">{{ .String "podcast.metadata.title" }}</div>
                  <ul class="list-horizontal-text color-subdue">
                    <li><span data-dynamic-relative-time="{{ div (.Int "publishedAt") 1000 }}"></span></li>
                    {{ $season := .String "season" }}
                    {{ $episode := .String "episode" }}
                    {{ if or $season $episode }}
                    <li hidden>{{ if $season }}S{{ $season }}{{ end }}{{ if $episode }}E{{ $episode }}{{ end }}</li>
                    {{ end }}
                    {{ $duration := .Int "duration" }}
                    {{ $hours := div $duration 3600 }}
                    {{ $minutes := mod (div $duration 60) 60 }}
                    <li class="flex gap-5 items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="icon-14">
                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8Zm7.75-4.25a.75.75 0 0 0-1.5 0V8c0 .414.336.75.75.75h3.25a.75.75 0 0 0 0-1.5h-2.5v-3.5Z" clip-rule="evenodd" />
                      </svg>
                    {{ if gt $hours 0 }}
                      {{ printf "%dh %dm" $hours $minutes }}
                    {{ else }}
                      {{ printf "%dm" $minutes }}
                    {{ end }}
                    </li>
                  </ul>
                </div>
            </div>
        </li>
        {{ end }}
      </ul>
    {{ else }}
      <p>Failed to fetch data</p>
    {{ end }}


- &audiobooks-recently-added
  type: custom-api
  title: Latest Audiobooks
  cache: *default-cache
  url: ${AUDIOBOOKSHELF_URL}/audiobookshelf/api/libraries/0519600d-6f54-457a-b601-4ab49646d84c/items
  parameters:
    limit: 15
    sort: addedAt
    desc: 1
  headers:
    Accept: application/json
    Authorization: Bearer ${AUDIOBOOKSHELF_KEY}
  template: |
    {{ $collapseAfter := .Options.IntOr "collapse-after" 5 }}
    {{ $items := .JSON.Array "results" }}
    {{ if $items }}
      <ul class="list list-gap-14 collapsible-container" data-collapse-after="{{ $collapseAfter }}">
        {{ range $items }}
        <li>
            <div class="flex gap-10 row-reverse-on-mobile thumbnail-parent">
                <div class="shrink-0">
                  <img class="twitch-category-thumbnail thumbnail aspect-ratio-1-1 cover-6-66" src="${AUDIOBOOKSHELF_URL}/audiobookshelf/api/items/{{ .String "id" }}/cover" alt="{{ .String "media.metadata.title" }}" loading="lazy">
                </div>
                <div class="grow min-width-0">
                  <a href="${AUDIOBOOKSHELF_URL}/audiobookshelf/item/{{ .String "id" }}" class="color-highlight size-title-dynamic block text-truncate" target="_blank" rel="noreferrer">{{ .String "media.metadata.title" }}</a>
                  <div class="text-truncate">{{ .String "media.metadata.authorName" }}</div>
                  <ul class="list-horizontal-text color-subdue">
                    <li>{{ .String "media.metadata.publishedYear" }}</li>
                    {{ $duration := .Int "media.duration" }}
                    {{ $hours := div $duration 3600 }}
                    {{ $minutes := mod (div $duration 60) 60 }}
                    <li class="flex gap-5 items-center">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="icon-14">
                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8Zm7.75-4.25a.75.75 0 0 0-1.5 0V8c0 .414.336.75.75.75h3.25a.75.75 0 0 0 0-1.5h-2.5v-3.5Z" clip-rule="evenodd" />
                      </svg>
                    {{ if gt $hours 0 }}
                      {{ printf "%dh %dm" $hours $minutes }}
                    {{ else }}
                      {{ printf "%dm" $minutes }}
                    {{ end }}
                    </li>
                  </ul>
                </div>
            </div>
        </li>
        {{ end }}
      </ul>
    {{ else }}
      <p>Failed to fetch data</p>
    {{ end }}
