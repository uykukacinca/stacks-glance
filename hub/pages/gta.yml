- name: "#gta" #
  slug: gta
  width: wide

  head-widgets:

    - type: split-column
      max-columns: 2
      widgets:

        - <<: *widget-twitch-carousel
          title: Twitch Streams
          body:
            query: |
              query {
                game(id: "32982") {
                  streams(first: 30, options: { languages: ["EN", "TR"] }) {
                    edges {
                      node {
                        id
                        createdAt
                        previewImageURL(width: 440, height: 248)
                        type
                        viewersCount
                        broadcaster {
                          login
                          displayName
                          profileImageURL(width: 300)
                          broadcastSettings {
                            title
                          }
                        }
                      }
                    }
                  }
                }
              }

        - <<: *widget-kick-category
          title: Kick Streams
          parameters:
            category: 8

  columns:

    - size: small
      widgets:

        - type: custom-api
          cache: *short-cache
          frameless: true
          title: Announcements
          title-url: https://www.rockstargames.com/newswire #?tag_id=666
          url: https://graph.rockstargames.com/
          parameters:
            operationName: NewswireList
            # latest: null # music: 30 # rockstar: 43 # tips: 121 # gtavi: 666 # gtav: 702 # updates: 705 # fanvideos: 706 # fanart: 708 # creator: 728 # rdr2: 736 # announcements: 722
            variables: '{"tagId":722,"page":1,"metaUrl":"/newswire","limit":20,"locale":"en_us"}'
            extensions: '{"persistedQuery":{"version":1,"sha256Hash":"aef12205cdcce5be34d9a2aa5e118635df895336ea5ea87e73b6b5d8a18ccc1a"}}'
          options:
            collapse-after: 6
          headers:
            Accept: application/json
          template: |
            {{ $collapseAfter := .Options.IntOr "collapse-after" 5 }}
            <div class="cards-grid collapsible-container" style="--cards-per-row: 1;" data-collapse-after-rows="{{ $collapseAfter }}">
            {{ range .JSON.Array "data.posts.results" }}
              <div class="card widget-content-frame thumbnail-parent">
                <img
                  class="video-thumbnail thumbnail"
                  loading="lazy"
                  src="{{ .String "preview_images_parsed.newswire_block.d16x9" }}"
                  alt=""
                />
                <div
                  class="margin-top-10 margin-bottom-widget flex flex-column grow padding-inline-widget"
                >
                  <div class="color-subdue">{{ .String "created" }}</div>
                  <div class="margin-bottom-7">
                    <a
                      class="visited-indicator text-truncate block"
                      href="https://www.rockstargames.com/newswire?tag_id={{ .String "primary_tags.0.id" }}"
                      target="_blank"
                      rel="noreferrer"
                      title="{{ .String "primary_tags.0.name" }}"
                      >{{ .String "primary_tags.0.name" }}</a
                    >
                  </div>
                  <a
                    class="text-truncate-2-lines margin-bottom-auto color-primary-if-not-visited"
                    href="https://www.rockstargames.com{{ .String "url" }}"
                    target="_blank"
                    rel="noreferrer"
                    title="{{ .String "title" }}"
                    >{{ .String "title" }}</a
                  >
                </div>
              </div>
            {{ end }}
            </div>

    - size: full
      widgets:

        - type: split-column
          max-columns: 3
          widgets:

            - <<: *reddit-cover
              subreddit: gta6
              title: GTA VI

            - <<: *reddit-cover
              subreddit: gta+gtaonline
              title: Grand Theft Auto & Online

            - <<: *reddit-cover
              subreddit: gtaiv+gtav
              title: GTA IV & V
