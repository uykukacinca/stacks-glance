- name: "#crew" # ðŸš–
  slug: crew
  width: wide
  columns:

    - size: small
      widgets:

        - type: bookmarks
          groups:
            - title: The Crew Motorfest
              links:
                - title: Steam Charts
                  icon: auto-invert ${ICONS_URL}/custom/steamdb.svg
                  url: https://steamdb.info/app/2698940/charts/
                - title: Steam Community
                  icon: auto-invert ${ICONS_URL}/steam-dark
                  url: https://steamcommunity.com/app/2698940/discussions/
                - title: "@TheCrewGame"
                  icon: auto-invert ${ICONS_URL}/x-dark
                  url: https://x.com/thecrewgame?lang=en
                - title: "r/The_Crew"
                  icon: auto-invert ${ICONS_URL}/reddit-dark
                  url: ${REDDIT_URL}/r/The_Crew/
            - links:
                - title: PC Gaming Wiki
                  url: https://www.pcgamingwiki.com/wiki/The_Crew_Motorfest

        - type: custom-api
          title: News & Updates
          cache: *long-cache
          title-url: https://www.ubisoft.com/en-gb/game/the-crew/motorfest/news-updates
          url: https://nimbus.ubisoft.com/api/v1/items
          parameters:
            # locale: en-gb
            # fallbackLocale: en-gb
            # categoriesfilter: all
            limit: 10
            # mediafilter: &&all
            # skip: 0
            # startIndex: 0
            tags: "BR-the-crew GA-the-crew-motorfest"
            # environment: master
          headers:
            Authorization: vBD74x38DZbzhwTWaTdhV63Zsec9yuFj
          template: |
            {{ $items := .JSON.Array "items" }}
            {{ if $items }}
              <ul class="list list-gap-10 collapsible-container" data-collapse-after="5">
              {{ range $items }}
                {{ $type := .String "type" }}
                {{ $thumbnail := .String "thumbnail.url" }}
                {{ $title := .String "title" }}
                {{ $url := concat "https://www.ubisoft.com/en-gb/game/the-crew/motorfest/news-updates" (.String "button.buttonUrl") }}
                {{ if eq $type "videos" }}
                  {{ $url = concat "https://www.youtube.com/watch?v=" (.String "id") }}
                {{ end }}
                <li class="flex">
                  <div data-popover-type="html">
                    <div data-popover-html="">
                      <img src="{{ $thumbnail }}" loading="lazy" alt="{{ $title }}">
                    </div>
                    <a class="size-title-dynamic color-primary-if-not-visited" href="{{ $url }}">{{ $title }}</a>
                  </div>
                </li>
              {{ end }}
              </ul>
            {{ else }}
              <p>Failed to fetch data</p>
            {{ end }}

        - type: custom-api
          title: Server Status
          cache: *no-cache
          title-url: https://www.ubisoft.com/en-gb/help/game/the-crew-motorfest
          url: https://public-ubiservices.ubi.com/v1/applications/gameStatuses
          headers:
            Ubi-AppId: 4391c956-8943-48eb-8859-07b0778f47b9
          parameters:
            applicationIds: 834a05c0-da46-4ed4-b9a9-a62e7e9ec869,bfd76e88-c4e6-4551-acc0-4145ef9156e0,1dbaf363-efe0-4c46-8298-2c2470baf4f5,664939eb-8c2b-440e-862d-30b5afe8b685,209fa8c3-9182-40ef-a29c-3a987cc7e9bd,ad33a082-c16d-4746-92e5-c632456eb180,7f32dbf2-c999-465a-ad70-df5e45fe9ae5
              # - 834a05c0-da46-4ed4-b9a9-a62e7e9ec869 # The Crew Motorfest - PC - LIVE
          template: |
            {{ $lastModifiedAt := .JSON.String "lastModifiedAt" }}
            {{ if $lastModifiedAt }}
              {{ $items := .JSON.Array "gameStatuses" }}
              <div class="flex flex-column gap-10">
                <div>
                  <span data-popover-type="html">
                    <div data-popover-html="">
                      {{ $lastModifiedAt | parseLocalTime "rfc3339" }}
                    </div>
                    Last update: <span {{ $lastModifiedAt | parseTime "rfc3339" | toRelativeTime }}></span>
                  </span>
                </div>
                <ul class="list">
                {{ range $items }}
                  {{ $status := .String "status" }}
                  <li>
                  <div class="flex items-center gap-10 padding-block-5">
                    {{ if eq $status "online" }}
                    <div class="square-18 shrink-0" title="Online">
                      <svg fill="var(--color-positive)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z" clip-rule="evenodd" />
                      </svg>
                    </div>
                    {{ else }}
                    <div class="square-18 shrink-0" title="Offline">
                      <svg fill="var(--color-negative)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z" clip-rule="evenodd" />
                      </svg>
                    </div>
                    {{ end }}
                    <div class="size-h4 color-highlight block text-truncate">{{ .String "name" | replaceAll "The Crew Motorfest - " "" | replaceAll " - LIVE" "" }}</div>
                  </div>
                  </li>
                {{ end }}
                </ul>
              </div>
            {{ else }}
              <p>Failed to fetch data</p>
            {{ end }}

    - size: full
      widgets:

        - <<: *backube-latest
          title: "Videos"
          options:
            collapse-after-rows: 3
          parameters:
            <<: *backube-video-parameters
            perPage: 36
            filter: kind="video"&&channel.tags?~"ic0n017w4rlbo7v"&&channel.category="5doguxzor0eekxd"

        - <<: *backube-latest
          title: Videos
          options:
            collapse-after-rows: 3
          parameters:
            <<: *backube-video-parameters
            perPage: 36
            filter: kind="video"&&channel.tags?~"4nhdxhpy2ytu5ms"&&channel.category="d6rzqzfpcfpvh7w"
